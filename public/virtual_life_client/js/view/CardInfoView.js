var view,__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){var t=function(e){function t(){var t=e.call(this)||this;t.stockData=null,t.btn_checkout.clickHandler=new Handler(t,t.onCheckout),t.btn_head.clickHandler=new Handler(t,t.onHead),t.btn_share.clickHandler=new Handler(t,t.onShare),t.btn_buy.clickHandler=new Handler(t,t.onBuy),t.btn_sell.clickHandler=new Handler(t,t.onSell),t.sld_num.changeHandler=new Handler(t,t.onNumSliderChanged),t.list_history.renderHandler=new Handler(t,t.onListRender);var r=Stocks.currentSelected;return Stocks.currentSelected=null,Stocks.data.length>r&&(t.stockData=Stocks.data[r.valueOf()],NetHelper.getInstance().httpGetStockTicker(t.stockData.stock_code,t,t.onTickerRecived),NetHelper.getInstance().httpGetOrderDepth(t.stockData.stock_code,t,t.onDepthRecived),NetHelper.getInstance().httpGetOrderHis(t.stockData.stock_code,t,t.onHistoryRecived),NetHelper.getInstance().httpGetKline(t.stockData.stock_code,t,t.onKlineRecived)),t.refreshInfo(),t}return __extends(t,e),t.prototype.onKlineRecived=function(e){console.log(e);var t=JSON.parse(e);if(null!=t){for(var r=[],n=Number.MIN_VALUE,o=0;o<t.length;o++){var i=Number(t[o]);i>n&&(n=i)}for(var c=0;c<t.length;c++){var l=120*c-2,a=206-206/(2*n)*Number(t[c]);r.push(l),r.push(a)}r.push(478),r.push(203),r.push(-2),r.push(203),null!=this.spr_kline&&(this.spr_kline.graphics.clear(),this.spr_kline.graphics.drawPoly(2,1,r,"#095d5d","#19bcbc",1));for(var s=new Date,h=new Date,d=5;d>0;d--){var u=this.img_kLines.getChildByName("time"+d);null!=u&&(h.setTime(s.getTime()-864e5*(5-d)),u.changeText(h.toLocaleDateString()))}}},t.prototype.onDepthRecived=function(e){var t=JSON.parse(e);if(null!=t){var r=t.sell,n=t.buy;if(null!=r)for(a=0;a<r.length;a++){var o=r[a],i=this.bx_depth.getChildByName("s"+(a+1));if(null!=i){var c=i.getChildByName("price"),l=i.getChildByName("count");null!=c&&(c.text=Number(o[0]).toFixed(2)),null!=l&&(l.text=Number(o[1]).toFixed(0))}}if(null!=n)for(var a=0;a<n.length;a++){var o=n[a],s=this.bx_depth.getChildByName("b"+(a+1));if(null!=s){var c=s.getChildByName("price"),l=s.getChildByName("count");null!=c&&(c.text=Number(o[0]).toFixed(2)),null!=l&&(l.text=Number(o[1]).toFixed(0))}}}},t.prototype.onTickerRecived=function(e){var t=JSON.parse(e);null!=t&&(this.txt_price.text=Number(t.price).toFixed(2),this.ti_price.text=this.txt_price.text,this.txt_highprice.changeText(t.highest_price),this.txt_lowprice.changeText(t.lowest_price))},t.prototype.onHistoryRecived=function(e){var t=JSON.parse(e);null!=t&&(this.list_history.array=t)},t.prototype.onOrderComplete=function(e){var t=JSON.parse(e);null!=t&&t.hasOwnProperty("code")&&(t.code>=0?alert(t.error):alert(t.message))},t.prototype.onListRender=function(e,t){if(!(t>this.list_history.array.length)){var r=this.list_history.array[t],n=e.getChildByName("his_time"),o=e.getChildByName("his_unitprice"),i=e.getChildByName("his_num"),c=e.getChildByName("his_price");null!=n&&(n.text=r.created_at),null!=o&&(o.text=Number(r.price).toFixed(2)),null!=i&&(i.text=Number(r.shares).toFixed(0)),null!=c&&(c.text=(Number(r.price)*Number(r.shares)).toFixed(2))}},t.prototype.onNumSliderChanged=function(e){},t.prototype.onCheckout=function(){console.log("on checkout clicked!")},t.prototype.onHead=function(){console.log("on head clicked!")},t.prototype.onShare=function(){console.log("on share clicked!")},t.prototype.onBuy=function(){console.log("on buy clicked!");var e="direction=buy&stock_code="+this.txt_number.text+"&price="+this.ti_price.text+"&shares="+this.ti_count.text;NetHelper.getInstance().httpPlaceOrder(e,this,this.onOrderComplete)},t.prototype.onSell=function(){console.log("on sell clicked!");var e="direction=sell&stock_code="+this.txt_number.text+"&price="+this.ti_price.text+"&shares="+this.ti_count.text;NetHelper.getInstance().httpPlaceOrder(e,this,this.onOrderComplete)},t.prototype.refreshInfo=function(){for(var e=0,t=UserInfo.UserInfoPriceData;e<t.length;e++){var r=t[e];if(r.stock_code==this.stockData.stock_code){this.txt_holdnum.text=Number(r.available_shares).toFixed(0);break}}this.txt_number.text=this.stockData.stock_code,this.txt_username.text=this.stockData.owner.nickname},t}(ui.CardInfoViewUI);e.CardInfoView=t}(view||(view={}));